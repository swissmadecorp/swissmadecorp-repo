/* Ephox Spell Checker Pro
 *
 * Copyright 2010-2016 Ephox Corporation.  All rights reserved.
 *
 * Version: 1.1.0-128
 */

!function(S){"use strict";var e,n,t,r,o,c=function(e){return parseInt(e,10)},i=function(e,n,t){return{major:e,minor:n,patch:t}},a=function(e){var n=/([0-9]+)\.([0-9]+)\.([0-9]+)(?:(\-.+)?)/.exec(e);return n?i(c(n[1]),c(n[2]),c(n[3])):i(0,0,0)},u=function(e,n){var t=e-n;return 0===t?0:0<t?1:-1},w=function(e,n){return!!e&&-1===function(e,n){var t=u(e.major,n.major);if(0!==t)return t;var r=u(e.minor,n.minor);if(0!==r)return r;var o=u(e.patch,n.patch);return 0!==o?o:0}(a([(t=e).majorVersion,t.minorVersion].join(".").split(".").slice(0,3).join(".")),a(n));var t},s=function(r,o){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var t=r.console;t&&o in t&&t[o].apply(t,arguments)}},b={log:s(S.window,"log"),error:s(S.window,"error"),warn:s(S.window,"warm")},N=function(e,n){e.addCommand("mceSpellCheck",n.spellcheck)},T=function(e){return e.getParam("spellchecker_dialog",!1,"boolean")},B=function(e){return e.getParam("spellchecker_language","en_us","string")},I=function(e,n){e.settings.spellchecker_language=n},C=function(e){return e.getParam("spellchecker_languages","US English=en_us,UK English=en_gb,Danish=da,Dutch=nl,Finnish=fi,French=fr,German=de,Italian=it,Norwegian=nb,Brazilian Portuguese=pt,Iberian Portuguese=pt_pt,Spanish=es,Swedish=sv","string")},O=function(e){return e.getParam("spellchecker_whitelist",[],"array")},f=function(e){return e.getParam("api_key")||e.getParam("spellchecker_api_key")},M=function(e){return e.getParam("spellchecker_handler")},d=function(e){return e.getParam("spellchecker_rpc_url")},_=function(e){return e.getParam("spellchecker_on_load",!1,"boolean")},A=function(e){return e.getParam("spellchecker_active",!0,"boolean")},x=function(e){return function(){return e}},l=x(!1),g=x(!0),h=function(n){return function(e){return function(e){if(null===e)return"null";var n=typeof e;return"object"===n&&Array.prototype.isPrototypeOf(e)?"array":"object"===n&&String.prototype.isPrototypeOf(e)?"string":n}(e)===n}},P=h("string"),p=h("undefined"),E=h("function"),D=h("number"),m="tinyMCESpellingCache",L=function(){var o=p(L)||null===S.sessionStorage?{get:x({}),set:function(e){}}:{get:function(){var e=S.sessionStorage.getItem(m);return e?JSON.parse(e):{}},set:function(e){var n=JSON.stringify(e);S.sessionStorage.setItem(m,n)}};return{read:function(e,n){var t=o.get();return n(void 0===t[e]?{}:t[e])},use:function(e,n){var t=o.get();void 0===t[e]&&(t[e]={});var r=n(t[e]);return o.set(t),r}}},v=l,k=g,y=function(){return W},W=(r={fold:function(e,n){return e()},is:v,isSome:v,isNone:k,getOr:t=function(e){return e},getOrThunk:n=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:function(){return null},getOrUndefined:function(){},or:t,orThunk:n,map:y,ap:y,each:function(){},bind:y,flatten:y,exists:v,forall:k,filter:y,equals:e=function(e){return e.isNone()},equals_:e,toArray:function(){return[]},toString:x("none()")},Object.freeze&&Object.freeze(r),r),R=function(t){var e=function(){return t},n=function(){return o},r=function(e){return e(t)},o={fold:function(e,n){return n(t)},is:function(e){return t===e},isSome:k,isNone:v,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:n,orThunk:n,map:function(e){return R(e(t))},ap:function(e){return e.fold(y,function(e){return R(e(t))})},each:function(e){e(t)},bind:r,flatten:e,exists:r,forall:r,filter:function(e){return e(t)?o:W},equals:function(e){return e.is(t)},equals_:function(e,n){return e.fold(v,function(e){return n(t,e)})},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return o},F={some:R,none:y,from:function(e){return null==e?W:R(e)}},j=Array.prototype.slice,U=void 0===(o=Array.prototype.indexOf)?function(e,n){return J(e,n)}:function(e,n){return o.call(e,n)},z=function(e,n){for(var t=e.length,r=new Array(t),o=0;o<t;o++){var c=e[o];r[o]=n(c,o,e)}return r},q=function(e,n){for(var t=0,r=e.length;t<r;t++)n(e[t],t,e)},H=function(e,n){for(var t=[],r=0,o=e.length;r<o;r++){var c=e[r];n(c,r,e)&&t.push(c)}return t},K=function(e,n){for(var t=0,r=e.length;t<r;t++)if(n(e[t],t,e))return F.some(t);return F.none()},J=function(e,n){for(var t=0,r=e.length;t<r;++t)if(e[t]===n)return t;return-1},V=E(Array.from)?Array.from:function(e){return j.call(e)},Y=function(e){return F.from(e.getAttribute("data-mce-index")).filter(function(e){return 0<e.length}).map(function(e){return parseInt(e,10)})},G=function(t,e){var r,o=[];if((r=V(e.getElementsByTagName("span"))).length)for(var n=function(n){Y(r[n]).each(function(e){e===t&&o.push(r[n])})},c=0;c<r.length;c++)n(c);return o},X=function(n,t,e,r,o,c){Q(n,e,r);var i=o.find(c,e);i=H(i,function(e){return!!t[e.text]}),o.wrap(i,function(e){return n.create("span",{class:r,"aria-invalid":"spelling","data-mce-bogus":1,"data-mce-word":e.text})},e)},$=function(e){var n=e.parentNode,t=e.childNodes;if(n){for(;0<t.length;)n.insertBefore(t[0],e);n.removeChild(e)}},Q=function(e,n,t){var r=e.select("span."+t,n);q(r,function(e){$(e)})},Z=tinymce.util,ee=Z.JSON,ne=Z.URI,te=Z.XHR,re=function(p,s){var m,v,k=0,y=function(e,t,r){var n,o,c,i=d(p),a={url:new ne(s).toAbsolute((n=i+"/1/correction",o=l(),c=(-1===n.indexOf("?")?"?":"&")+"apiKey="+encodeURIComponent(o),P(o)?n+c:n)),type:"post",content_type:"application/json",data:ee.serialize(e),success:function(e){var n=ee.parse(e);n?t(n):r("Server response wasn't valid json.")},error:function(){r(tinymce.translate(["The spelling service was not found: ({0})",i]))}},u=l();u&&(a.requestheaders=[{key:"tiny-api-key",value:u}]),i?te.send(a):r("You need to specify the spellchecker_rpc_url setting.")},x=function(e,n,t,r,o){if(m.push(e),m.length===v){var c=function(e){for(var n={},t=0;t<e.length;t++)for(var r in e[t].spell)n[r]=e[t].spell[r];return n}(m);r(o.cacheAndCombineResults(n.cachedData,c,n.wordsToCheck),t)}},w=function(e){p.setProgressState(!1),p.notificationManager.open({text:e,type:"error"}),k++},l=function(){return f(p)};return{spellcheck:function(e,n,t,r,o){var c=r.getCachedCleanedWords(o.filter(e));if(!(5<k)){var i,a,u,s,l=function(e){x(e,c,n,t,r)},f=function(e){w(e)};if(0<c.wordsToCheck.length)for(var d=function(e){for(var n=0,t=0,r=[],o=0;o<e.length;o++)15e3<(n+=e[o].length)&&(r.push({words:e.slice(t,o+1),language:B(p)}),t=o+1,n=0);return t!==e.length&&r.push({words:e.slice(t,e.length),language:B(p)}),v=r.length,m=[],r}(c.cleanedWordsForServer),g=0;g<d.length;g++)i=d[g],a=l,u=f,s=M(p),(E(s)?s:y)(i,a,u);else{var h=r.cacheAndCombineResults(c.cachedData,{},c.wordsToCheck);t(h,n)}}}}},oe=function(e,n){e.fire("SpellcheckerIgnore",{word:n})},ce=function(e,n){e.fire("SpellcheckerIgnoreAll",{word:n})},ie=tinymce.dom.DOMUtils.DOM,ae=function(e,n,t){if(0<n.length){var r=S.document.createTextNode(t);return ie.replace(r,n[0]),o=e,c=n.slice(1),q(c,function(e){var n=function(e,n){for(var t=[];e.parentNode&&e.parentNode!==n;)e=e.parentNode,t.push(e);return t}(e,o);ie.remove(e),q(n,function(e){ie.isEmpty(e)&&ie.remove(e,!0)})}),r}var o,c;return null},ue=function(n,e,t,r,o,c){n.selection.collapse(),1===o?(e.addWord(t),q(n.dom.select("span.mce-spellchecker-word"),function(e){e.getAttribute("data-mce-word")===t&&n.dom.remove(e,!0)})):c?n.dom.remove(r,!0):q(r,function(e){e.className="mce-spellchecker-ignore"}),1===o?ce(n,t):oe(n,t)},se=function(e){return F.from(e.getAttribute("data-mce-word"))},le=function(t){var e,n=(e=t,F.from(e.dom.select("span.mce-spellchecker-word")[0])),r=n.map(function(e){return n=t,Y(e).map(function(e){return G(e,n.getBody())}).getOr([]);var n}).getOr([]);return n.bind(se).map(function(e){return{wordText:e,spans:r}})},fe=function(r,o,c){r.undoManager.transact(function(){var e,n,t=ae(r.getBody(),o,c);t&&(r.focus(),r.selection.setRng((e=t,(n=r.dom.createRng()).setStart(e,0),n.setEnd(e,e.data.length),n)))})},de=function(t,r,o,c){le(t).each(function(e){var n;r!==e.wordText?n=r:o&&(n=o),n&&(ae(t.getBody(),e.spans,n),t.undoManager.add(),c())})},ge=function(e,n){for(var t=e.getBody(),r=t,o=e.schema.getBlockElements();n!==t&&n.parentNode;){if(o[n.nodeName]){r=n;break}n=n.parentNode}return r},he=tinymce.dom.DOMUtils,pe=function(c,i){return function(e){if(37!==(e.which||e.keyCode)&&38!==(e.which||e.keyCode)&&39!==(e.which||e.keyCode)&&40!==(e.which||e.keyCode))if("ContextMenu"!==e.code){var t=c.selection.getNode();if(he.DOM.hasClass(t,"mce-spellchecker-word")||he.DOM.hasClass(t,"mce-spellchecker-ignore")){var n=Y(t).map(function(e){var n=ge(c,t);return G(e,n)}).getOr([]);if(0<n.length){for(var r=c.selection.getBookmark(),o=0;o<n.length;o++)$(n[o]);c.selection.moveToBookmark(r)}}}else i&&i(c.selection.getStart(),!0)&&(e.preventDefault(),e.stopImmediatePropagation())}},me=function(c,i){return function(e){var n,t,r=c.selection.getNode(),o=ge(c,r);(32===((t=e).which||t.keyCode)||13===((n=e).which||n.keyCode)&&n.shiftKey)&&i(o)}},ve=function(e,n,t,r){if(!1===e.selection.isCollapsed())return n;var o,c,i,a=n;return c=t,i=(o=e).getBody(),(o.$.contains(i,c)||i===c)&&(a===(n=ge(e,t))||a&&r(a)),n},ke=function(e){return e&&3===e.nodeType},ye=function(e){return e&&(n=e)&&1===n.nodeType&&"false"===e.contentEditable;var n},xe=function(e,t){var m,v,k,y=e.dom;m=e.schema.getBlockElements(),v=e.schema.getWhiteSpaceElements(),k=e.schema.getShortEndedElements();var c=function(e){if(!e[0])throw new Error("findAndReplaceDOMText cannot handle zero-length matches");return{start:e.index,end:e.index+e[0].length,text:e[0]}},i=function(e){var n;if(ke(e))return e.data;if(v[e.nodeName]&&!m[e.nodeName])return"";if(ye(e))return"\n";if(n="",(m[e.nodeName]||k[e.nodeName])&&(n+="\n"),e=e.firstChild)for(;n+=i(e),e=e.nextSibling;);return n},r=function(e,n,t){var r,o,c,i,a,u,s,l,f,d=[],g=0,h=e,p=0;n=n.slice(0),u=n,s=function(e,n){return e.start-n.start},(l=j.call(u,0)).sort(s),a=(n=l).shift();e:for(;;){if((m[h.nodeName]||k[h.nodeName]||ye(h))&&g++,ke(h)&&(!o&&a&&h.length+g>=a.end?(o=h,i=a.end-g):r&&d.push(h),!r&&a&&h.length+g>a.start&&(r=h,c=a.start-g),g+=h.length),a&&r&&o&&D(c)&&D(i)){if(f=y.getParents(r,x(!0),e),K(f,function(e){return"mce-spellchecker-ignore"===e.className}).isSome()||(h=t({startNode:r,endNode:o,startNodeIndex:c,endNodeIndex:i,innerNodes:d,match:a.text,matchIndex:p}),g-=o.length-i),i=c=o=r=null,d=[],p++,!(a=n.shift()))break}else if(v[h.nodeName]&&!m[h.nodeName]||!h.firstChild){if(h.nextSibling){h=h.nextSibling;continue}}else if(!ye(h)){h=h.firstChild;continue}for(;;){if(h.nextSibling){h=h.nextSibling;break}if(!h.parentNode||h.parentNode===e)break e;h=h.parentNode}}};return{getText:i,getWords:function(e){var n=i(e).match(t);return n?function(e){for(var n,t,r=[],o=0;o<e.length;o++)n=r,t=e[o],-1<U(n,t)||r.push(e[o]);return r}(n):[]},find:function(e,n){var t=[],r=i(n);if(r&&e.global)for(var o=void 0;o=e.exec(r);)t.push(c(o));return t},wrap:function(e,n,t){var o,c,m;e.length&&r(t,e,(o=e,c=n,m=function(e,n){var t=o[n];t.stencil||(t.stencil=c(t));var r=t.stencil.cloneNode(!1);return r.setAttribute("data-mce-index",n.toString()),e&&r.appendChild(y.doc.createTextNode(e)),r},function(e){var n,t,r,o=e.startNode,c=e.endNode,i=e.matchIndex,a=y.doc;if(o===c){var u=o,s=m(e.match,i);return(r=u.parentNode)&&(0<e.startNodeIndex&&(n=a.createTextNode(u.data.substring(0,e.startNodeIndex)),r.insertBefore(n,u)),r.insertBefore(s,u),e.endNodeIndex<u.length&&(t=a.createTextNode(u.data.substring(e.endNodeIndex)),r.insertBefore(t,u)),r.removeChild(u)),s}n=a.createTextNode(o.data.substring(0,e.startNodeIndex)),t=a.createTextNode(c.data.substring(e.endNodeIndex));for(var l=m(o.data.substring(e.startNodeIndex),i),f=0,d=e.innerNodes.length;f<d;++f){var g=e.innerNodes[f],h=m(g.data,i);y.replace(h,g)}var p=m(c.data.substring(0,e.endNodeIndex),i);return(r=o.parentNode)&&(r.insertBefore(n,o),r.insertBefore(l,o),r.removeChild(o)),(r=c.parentNode)&&(r.insertBefore(p,c),r.insertBefore(t,c),r.removeChild(c)),p}))}}},we=tinymce.dom.DOMUtils,be=function(u,s,r,e,o){var l,n,t,c,i,a=A(u),f=function(e,n){if(u.selection){var t=u.selection.getBookmark();X(u.dom,e,n,"mce-spellchecker-word",g(),o),u.selection.moveToBookmark(t)}},d=re(u,e),g=function(){return i||(i=xe(u,o)),i},h=function(e,n,t){ue(u,r,e,n,t,!1)},p=function(e){d.spellcheck(g().getWords(e),e,f,s,r)},m=function(e){p(e),u.focus()},v=function(){l&&(l.remove(),l=void 0)},k=function(n,e){if(we.DOM.hasClass(n,"mce-spellchecker-word")){var t=Y(n).map(function(e){return G(e,ge(u,n))}).getOr([]);if(0<t.length){var r=u.dom.createRng();r.setStartBefore(t[0]),r.setEndAfter(t[t.length-1]),u.selection.setRng(r);var o=n.getAttribute("data-mce-word");o&&function(e,n,t){var r=s.retrieveWordFromCache(B(u),e).suggestions,o=[];q(r,function(e){o.push({text:e,onclick:function(){fe(u,n,e)}})}),o.push({text:"-"}),o.push.apply(o,[{text:"Ignore",onclick:function(){h(e,n,0)}},{text:"Ignore all",onclick:function(){h(e,n,1)}}]),(l=tinymce.ui.Factory.create("menu",{items:o,context:"contextmenu",onautohide:function(e){-1!==e.target.className.indexOf("spellchecker")&&e.preventDefault()},onhide:function(){l.remove(),l=null}})).renderTo(S.document.body);var c=we.DOM.getPos(u.getContentAreaContainer()),i=u.dom.getPos(n[0]),a=u.dom.getRoot();"BODY"===a.nodeName?(i.x-=a.ownerDocument.documentElement.scrollLeft||a.scrollLeft,i.y-=a.ownerDocument.documentElement.scrollTop||a.scrollTop):(i.x-=a.scrollLeft,i.y-=a.scrollTop),c.x+=i.x,c.y+=i.y,l.moveTo(c.x,c.y+n[0].offsetHeight),t&&l.items()[0].focus()}(o,t,e)}return!0}return!1},y=pe(u,k),x=me(u,m),w=function(){u.on("remove",v),u.on("keydown",y),u.on("keyup",x),u.on("nodechange",C)},b=function(){u.off("remove",v),u.off("keydown",y),u.off("keyup",x),u.off("nodechange",C)},C=function(e){e.selectionChange||(n=ve(u,n,e.element,m))};return u.on("contextmenu",function(e){k(e.target,!1)&&(e.preventDefault(),e.stopImmediatePropagation())},!0),u.on("init",function(){_(u)&&setTimeout(function(){var e=u.getBody();e&&p(e)},1e3)}),a&&w(),{setLanguage:function(e){I(u,e),a&&m(u.getBody())},getLanguage:function(){return B(u)},spellcheck:function(){a?(b(),Q(u.dom,u.getBody(),"mce-spellchecker-word")):(w(),m(u.getBody())),a=!a,t&&t.active(a),c&&c.active(a)},isChecking:function(){return a},onButtonSetup:function(e){(t=e.control).active(a)},onMenuItemSetup:function(e){var n=this;c=e.control,e.control.on("show",function(){n.active(a)}),c.active(a)}}},Ce=function(n){return{layout:"flex",align:"stretch",direction:"column",title:"Spellcheck",spacing:10,padding:10,callbacks:n,minWidth:350,items:[{type:"label",name:"textlabel",text:"Misspelled word"},{type:"textbox",name:"text",ariaLabel:"Misspelled word",spellcheck:!1},{type:"label",name:"suggestionslabel",text:"Suggestions"},{type:"container",layout:"flex",direction:"row",align:"stretch",spacing:10,items:[{type:"selectbox",name:"suggestions",ariaLabel:"Suggestion",minWidth:150,flex:1,size:6,border:1},{type:"container",layout:"flex",flex:1,spacing:5,direction:"column",pack:"center",align:"stretch",items:[{type:"button",subtype:"primary",name:"change",text:"Change",onclick:"change"},{type:"button",name:"ignore",text:"Ignore",onclick:"ignore"},{type:"button",name:"ignoreall",text:"Ignore all",onclick:"ignoreall"}]}]}],onsubmit:function(e){e.preventDefault(),n.submit()},buttons:[{text:"Close",onclick:"close"}]}},Se=function(e){return e.fire("SpellcheckStart")},Ne=function(e){return e.fire("SpellcheckEnd")},Te=tinymce.dom.DOMUtils,Be=function(i,a,r,e,o){var n,t,c=A(i),u=function(e,n){if(i.selection){var t=i.selection.getBookmark();X(i.dom,e,n,"mce-spellchecker-word",l(),o),i.selection.moveToBookmark(t)}},s=re(i,e),l=function(){return t||(t=xe(i,o)),t},f=function(e,n,t){ue(i,r,e,n,t,!1),i.focus()},d=function(e){s.spellcheck(l().getWords(e),e,u,a,r)},g=function(e){d(e),i.focus()},h=pe(i),p=me(i,g),m=function(){i.on("keydown",h),i.on("keyup",p),i.on("nodechange",k)},v=function(){i.off("keydown",h),i.off("keyup",p),i.off("nodechange",k)},k=function(e){e.selectionChange||(n=ve(i,n,e.element,g))};return i.ui.registry.addContextMenu("spellchecker",{update:function(n){if(Te.DOM.hasClass(n,"mce-spellchecker-word")){var t=Y(n).map(function(e){return G(e,ge(i,n))}).getOr([]);if(0<t.length){var e=i.dom.createRng();return e.setStartBefore(t[0]),e.setEndAfter(t[t.length-1]),i.selection.setRng(e),F.from(n.getAttribute("data-mce-word")).map(function(e){return function(e,n){var t=a.retrieveWordFromCache(B(i),e).suggestions,r=[],o=[];if(4<t.length){var c=t.splice(3);q(c,function(e){o.push({text:e,onAction:function(){return fe(i,n,e)}})})}return q(t,function(e){r.push({text:e,onAction:function(){return fe(i,n,e)}})}),0<o.length&&r.push({type:"submenu",text:"More...",getSubmenuItems:function(){return o}}),r.push.apply(r,[{type:"separator"},{text:"Ignore",onAction:function(){f(e,n,0)}},{text:"Ignore all",onAction:function(){f(e,n,1)}}]),r}(e,t)}).getOr([])}}return[]}}),i.on("init",function(){_(i)&&setTimeout(function(){var e=i.getBody();e&&d(e)},1e3)}),c&&m(),{isChecking:function(){return c},spellcheck:function(){c?(c=!c,v(),Q(i.dom,i.getBody(),"mce-spellchecker-word"),Ne(i)):(c=!c,m(),g(i.getBody()),Se(i))},getLanguage:function(){return B(i)},setLanguage:function(e){I(i,e),c&&g(i.getBody())}}},Ie=function(t,e,n){return{title:"Spellcheck",body:{type:"panel",items:[{type:"input",name:"textlabel",label:"Misspelled word"},{type:"selectbox",name:"suggestions",label:"Suggestions",size:6,items:n}]},initialData:{textlabel:e,suggestions:void 0!==n[0]?n[0].value:""},onClose:function(){t.close()},onAction:function(e,n){switch(n.name){case"change":t.change();break;case"ignore":t.ignore();break;case"ignoreall":t.ignoreall()}e.focus("textlabel")},buttons:[{type:"custom",primary:!0,name:"change",text:"Change"},{type:"custom",name:"ignore",text:"Ignore"},{type:"custom",name:"ignoreall",text:"Ignore all"},{type:"cancel",text:"Close"}]}};function Oe(r,n,t,e,o){var c,i={},a=function(e,n){X(r.dom,e,n,"mce-spellchecker-word",s(),o),r.setProgressState(!1),p()},u=re(r,e),s=function(){return i.textMatcher||(i.textMatcher=xe(r,o)),i.textMatcher},l=function(e){return n.retrieveWordFromCache(B(r),e).suggestions},f=function(){var e=c.getData(),n=e.textlabel,t=e.suggestions;de(r,n,t,m)},d=function(n){le(r).each(function(e){ue(r,t,e.wordText,e.spans,n,!0),m()})},g=function(){Q(r.dom,r.getBody(),"mce-spellchecker-word")},h={change:f,submit:f,ignore:function(){d(0)},ignoreall:function(){d(1)},close:g},p=function(){le(r).fold(function(){var e=tinymce.translate("No misspellings found.");r.notificationManager.open({text:e,type:"info",timeout:3e3})},function(e){var n=l(e.wordText).map(function(e){return{text:e,value:e}});r.dom.addClass(e.spans,"mce-match-marker-selected"),c=r.windowManager.open(Ie(h,e.wordText,n))})},m=function(){le(r).fold(function(){g(),c.close()},function(e){var n=l(e.wordText).map(function(e){return{text:e,value:e}});c.redial(Ie(h,e.wordText,n)),r.dom.addClass(e.spans,"mce-match-marker-selected")})};return{setLanguage:function(e){I(r,e)},getLanguage:function(){return B(r)},spellcheck:function(){r.setProgressState(!0),u.spellcheck(s().getWords(r.getBody()),r.getBody(),a,n,t)},isChecking:function(){return!1}}}var Me,_e=function(t,r,e){var n,o=function(e){var n=B(t);q(e.control.items(),function(e){e.active(e.data.data===n)})},c=(n=e.split(","),z(n,function(e){var n=e.split("=");return{selectable:!0,text:n[0],data:n[1],onclick:function(){r.setLanguage(n[1])}}})),i={tooltip:"Spellcheck",onclick:r.spellcheck,onPostRender:r.onButtonSetup};1<c.length&&(i.type="splitbutton",i.menu=c,i.onshow=o),t.addButton("spellchecker",i),t.addMenuItem("spellchecker",{text:"Spellcheck",context:"tools",onclick:r.spellcheck,onPostRender:r.onMenuItemSetup,selectable:!0}),t.addMenuItem("spellcheckerlanguage",{text:"Spellcheck Language",context:"tools",menu:c,onPostRender:function(e){e.control.on("show",function(e){o(e)})}})},Ae=Object.prototype.hasOwnProperty,Pe=(Me=function(e,n){return n},function(){for(var e=new Array(arguments.length),n=0;n<e.length;n++)e[n]=arguments[n];if(0===e.length)throw new Error("Can't merge zero objects");for(var t={},r=0;r<e.length;r++){var o=e[r];for(var c in o)Ae.call(o,c)&&(t[c]=Me(t[c],o[c]))}return t}),Ee="SpellcheckStart SpellcheckEnd",De=function(t,r,e){var n,o=(n=e.split(","),z(n,function(e){var n=e.split("=");return{text:n[0],data:n[1]}})),c={tooltip:"Spellcheck",onAction:r.spellcheck,icon:"spell-check",active:r.isChecking(),onSetup:function(e){var n=function(){e.setActive(r.isChecking())};return n(),t.on(Ee,n),function(){return t.off(Ee,n)}}};1<o.length?t.ui.registry.addSplitButton("spellchecker",Pe(c,{select:function(e){return e===r.getLanguage()},fetch:function(e){e(z(o,function(e){return{type:"choiceitem",value:e.data,text:e.text}}))},onItemAction:function(e,n){return r.setLanguage(n)}})):t.ui.registry.addToggleButton("spellchecker",c),t.ui.registry.addToggleMenuItem("spellchecker",{text:"Spellcheck",onAction:r.spellcheck,onSetup:function(e){var n=function(){return e.setActive(r.isChecking())};return n(),t.on(Ee,n),function(){return t.off(Ee,n)}}});var i=function(e){return{type:"togglemenuitem",text:e.text,onAction:function(){return r.setLanguage(e.data)},active:e.data===r.getLanguage()}};t.ui.registry.addNestedMenuItem("spellcheckerlanguage",{text:"Spellcheck Language",getSubmenuItems:function(){return z(o,i)}})},Le=tinymce.PluginManager,We=function(e,n,t,r,o,c){var i,a,u,s,l,f,d,g,h,p,m,v,k,y,x,w,b,C=T(e)?(a=r,u=o,s=c,g={},h=function(e,n){X(i.dom,e,n,"mce-spellchecker-word",m(),s),i.setProgressState(!1),w()},p=re(i=e,n),m=function(){return g.textMatcher||(g.textMatcher=xe(i,s)),g.textMatcher},v=function(e){return a.retrieveWordFromCache(B(i),e).suggestions},y=function(n){le(i).each(function(e){ue(i,u,e.wordText,e.spans,n,!0),b()})},x={change:k=function(){var e=d.find("#text")[0].value(),n=d.find("#suggestions")[0].getEl().value;de(i,e,n,b)},submit:k,ignore:function(){y(0)},ignoreall:function(){y(1)},close:function(){d.close()}},w=function(){le(i).fold(function(){var e=tinymce.translate("No misspellings found.");i.notificationManager.open({text:e,type:"info",timeout:3e3})},function(e){l&&l.active(!0),f&&f.active(!0);var n=v(e.wordText);i.dom.addClass(e.spans,"mce-match-marker-selected"),(d=i.windowManager.open(Ce(x))).find("#text")[0].value(e.wordText),d.find("#suggestions")[0].options(n),d.find("#suggestions")[0].getEl().selectedIndex=0,d.find("#suggestions")[0].getEl().focus(),d.on("close",function(){l&&l.active(!1),f&&f.active(!1),d=void 0,Q(i.dom,i.getBody(),"mce-spellchecker-word")})})},b=function(){le(i).fold(function(){d&&d.close()},function(e){d.find("#text").value(e.wordText);var n=v(e.wordText),t=d.find("#suggestions")[0];t.options(n),t.getEl().selectedIndex=0,t.getEl().focus(),i.dom.addClass(e.spans,"mce-match-marker-selected")})},{setLanguage:function(e){I(i,e)},getLanguage:function(){return B(i)},spellcheck:function(){i.setProgressState(!0),p.spellcheck(m().getWords(i.getBody()),i.getBody(),h,a,u)},isChecking:function(){return!1},onButtonSetup:function(e){l=e.control},onMenuItemSetup:function(e){f=e.control}}):be(e,r,o,n,c);N(e,C),_e(e,C,t)};Le.requireLangPack("tinymcespellchecker","ar,ca,cs,da,de,el,es,fa,fi,fr_FR,he_IL,hr,hu_HU,it,ja,kk,ko_KR,nb_NO,nl,pl,pt_BR,pt_PT,ro,ru,sk,sl_SI,sv_SE,th_TH,tr,uk,zh_CN,zh_TW"),Le.add("tinymcespellchecker",function(e,n){if(w(tinymce,"4.2.8"))return b.error('The "tinymcespellchecker" plugin requires at least version 4.2.8 of TinyMCE.'),function(){};var a,o,i,u,s,l,t,r,c,f,d,g,h,p,m,v=e.getParam("spellchecker_wordchar_pattern")||new RegExp("[\\w'\\-\\u00C0-\\u00FF\\uFEFF\\u2018\\u2019]+","g"),k=C(e),y=(a=e,o=L(),i=function(e){return e.replace(/\uFEFF/g,"")},l=function(e){for(var n=0;n<e.length;n++)s(B(a),e[n].cleaned)||u(B(a),e[n].cleaned,!1,[])},{addWordToCache:u=function(e,n,t,r){o.use(e,function(e){e[i(n)]={misspelled:t,suggestions:r}})},retrieveWordFromCache:s=function(e,t){return o.read(e,function(e){var n=e[i(t)];return void 0!==n&&n.suggestions&&8<n.suggestions.length&&(n.suggestions=n.suggestions.slice(0,8)),n})},getCachedCleanedWords:function(e){for(var n={},t=[],r=[],o=0;o<e.length;o++){var c=s(B(a),e[o]);c&&c.misspelled&&(n[e[o]]=c),c||(t.push({original:e[o],cleaned:i(e[o])}),r.push(i(e[o])))}return{cachedData:n,wordsToCheck:t,cleanedWordsForServer:r}},cacheAndCombineResults:function(e,n,t){var r={};for(var o in e)e[o]&&e[o].misspelled&&(r[o]=e[o].suggestions);for(var c in n){u(B(a),c,!0,n[c]);for(var i=0;i<t.length;i++)if(t[i].cleaned===c){r[t[i].original]=n[c];break}}return l(t),r},cacheCorrectlySpelledWords:l}),x=(t={},{addWord:r=function(e){t[e.toLowerCase()]=!0},addWords:function(e){q(e,function(e){return r(e)})},filter:function(e){return H(e,function(e){return!t[e.toLowerCase()]})}});x.addWords(O(e)),w(tinymce,"5.0.0")?We(e,n,k,y,x,v):(f=n,d=k,g=y,h=x,p=v,m=T(c=e)?Oe(c,g,h,f,p):Be(c,g,h,f,p),N(c,m),De(c,m,d))})}(window);