/* Tiny Page Embed plugin
 *
 * Copyright 2010-2019 Tiny Technologies Inc. All rights reserved.
 *
 * Version: 1.0.1-26
 */
!function(t){"use strict";function r(e){return parseInt(e,10)}function o(e,n,r){return{major:e,minor:n,patch:r}}function i(e){var n=/([0-9]+)\.([0-9]+)\.([0-9]+)(?:(\-.+)?)/.exec(e);return n?o(r(n[1]),r(n[2]),r(n[3])):o(0,0,0)}function u(e,n){var r=e-n;return 0==r?0:0<r?1:-1}function n(e,n){return!!e&&-1===function(e,n){var r=u(e.major,n.major);if(0!==r)return r;var t=u(e.minor,n.minor);if(0!==t)return t;var o=u(e.patch,n.patch);return 0!==o?o:0}(function(e){return i(function(e){return[e.majorVersion,e.minorVersion].join(".").split(".").slice(0,3).join(".")}(e))}(e),i(n))}function e(){}function d(e){return function(){return e}}function a(){return l}var s,c=d(!1),f=d(!0),l=(s={fold:function(e,n){return e()},is:c,isSome:c,isNone:f,getOr:v,getOrThunk:p,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:d(null),getOrUndefined:d(void 0),or:v,orThunk:p,map:a,each:e,bind:a,exists:c,forall:f,filter:a,equals:m,equals_:m,toArray:function(){return[]},toString:d("none()")},Object.freeze&&Object.freeze(s),s);function m(e){return e.isNone()}function p(e){return e()}function v(e){return e}function g(n){return function(e){return function(e){if(null===e)return"null";var n=typeof e;return"object"==n&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==n&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":n}(e)===n}}function h(e,n){for(var r=0,t=e.length;r<t;r++){n(e[r],r)}}function b(e,n,r){!function(e,n,r){if(!(G(r)||K(r)||Q(r)))throw t.console.error("Invalid call to Attr.set. Key ",n,":: Value ",r,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(n,r+"")}(e.dom(),n,r)}function w(e,n){var r=e.dom().getAttribute(n);return null===r?void 0:r}function N(e,n){return X.from(w(e,n))}function O(e,n,r){return 0!=(e.compareDocumentPosition(n)&r)}function y(e,n){var r=function(e,n){for(var r=0;r<e.length;r++){var t=e[r];if(t.test(n))return t}}(e,n);if(!r)return{major:0,minor:0};function t(e){return Number(n.replace(r,"$"+e))}return ue(t(1),t(2))}function E(e,n){return function(){return n===e}}function x(e,n){return function(){return n===e}}function T(e,n){var r=String(n).toLowerCase();return function(e,n){for(var r=0,t=e.length;r<t;r++){var o=e[r];if(n(o,r))return X.some(o)}return X.none()}(e,function(e){return e.search(r)})}function S(e,n){return-1!==e.indexOf(n)}function D(n){return function(e){return S(e,n)}}function A(e){return function(e,n){var r=e.dom().childNodes;return X.from(r[n]).map(Y.fromDom)}(e,0)}function _(e,n,r){var t=function(e,n){var r=w(e,n);return void 0===r||""===r?[]:r.split(" ")}(e,n).concat([r]);return b(e,n,t.join(" ")),!0}function C(e){return void 0!==e.dom().classList}function R(e,n){C(e)?e.dom().classList.add(n):function(e,n){_(e,"class",n)}(e,n)}function I(e,n){return C(e)&&e.dom().classList.contains(n)}function L(e){return I(e,Ee)}function k(e){var n=e.attr("class");return n&&S(" "+n+" "," "+Ee+" ")}function M(o,i,u){return X.from(o).map(Y.fromDom).filter(L).bind(A).filter(function(e){return"iframe"===function(e){return e.dom().nodeName.toLowerCase()}(e)}).fold(function(){return i},function(e){function n(e,n,r){return X.from(w(e,n)).getOr(r)}var r,t;return{source:{value:n(e,"src",i.source.value)},size:(r=o,t=Y.fromDom(r),function(e,n,r){return h(e,function(e){r=n(r,e)}),r}(u,function(e,n){return I(t,n.value)?n.value:e},"inline")),dimensions:{width:n(e,"width",i.dimensions.width),height:n(e,"height",i.dimensions.height)},name:n(e,"name",i.name),title:n(e,"title",i.title),descriptionUrl:{value:n(e,"longdesc",i.descriptionUrl.value)},showBorder:N(e,"frameborder").map(function(e){return"0"!==e.toLowerCase()}).getOr(i.showBorder),scrollbar:N(e,"scrolling").map(function(e){return"yes"===e.toLowerCase()}).getOr(i.scrollbar)}})}function j(e,n){e.dom().appendChild(n.dom())}function P(e,n,r){0<r.trim().length&&b(e,n,r)}function U(e){var n=function(e){var n=Y.fromTag("div");return b(n,"contentEditable","false"),R(n,Ee),"inline"!==e.size&&R(n,e.size),n}(e),r=Y.fromTag("iframe");return P(r,"src",e.source.value),P(r,"title",e.title),P(r,"name",e.name),P(r,"longdesc",e.descriptionUrl.value),function(e,n){return re(e,n)?X.from(e[n]):X.none()}(e,"dimensions").each(function(e){P(r,"width",e.width),P(r,"height",e.height)}),e.showBorder||b(r,"frameborder","0"),b(r,"scrolling",e.scrollbar?"yes":"no"),j(n,r),function(e){var n=Y.fromTag("div"),r=Y.fromDom(e.dom().cloneNode(!0));return j(n,r),function(e){return e.dom().innerHTML}(n)}(n)}function z(t){var n=[{text:"Inline Value",value:"inline"}].concat(function(e){return void 0!==e.tiny_pageembed_classes}(t.settings)?function(e){return e.tiny_pageembed_classes}(t.settings):xe),r=function(e){return{title:"Insert/Edit Iframe",body:{type:"tabpanel",tabs:[{title:"General",items:function(e){for(var n=[],r=0,t=e.length;r<t;++r){if(!$(e[r]))throw new Error("Arr.flatten item "+r+" was not an array, input: "+e);ee.apply(n,e[r])}return n}([[{name:"source",type:"urlinput",filetype:"media",label:"Source"}],1<n.length?[{label:"Size",type:"selectbox",name:"size",items:n}]:[],"inline"===e.size?[{type:"sizeinput",name:"dimensions",label:"Constrain proportions",constrain:!0}]:[]])},{title:"Advanced",items:[{name:"name",type:"input",label:"Name"},{name:"title",type:"input",label:"Title"},{name:"descriptionUrl",type:"urlinput",label:"Long description URL"},{type:"label",label:"Border",items:[{type:"checkbox",name:"showBorder",label:"Show iframe border"}]},{type:"label",label:"Scrollbar",items:[{type:"checkbox",name:"scrollbar",label:"Enable scrollbar"}]}]}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"submit",text:"Save",primary:!0}],onChange:function(e,n){"size"===n.name&&(e.redial(r(e.getData())),e.focus("size"))},onSubmit:function(e){var n=e.getData();if(0<n.source.value.length){var r=U(n);t.insertContent(r),t.nodeChanged()}e.close()},initialData:e}},e=t.selection.getNode(),o=M(e,{source:{value:""},size:"inline",dimensions:{width:"350px",height:"260px"},name:"",title:"",descriptionUrl:{value:""},showBorder:!0,scrollbar:!1},n);t.windowManager.open(r(o))}function B(r){r.ui.registry.addToggleButton("pageembed",{icon:"embed-page",tooltip:"Embed iframe",onAction:function(e){z(r)},onSetup:function(n){function e(e){return n.setActive(!r.readonly&&e.element.classList.contains(Ee))}return r.on("nodechange",e),function(){return r.off("nodechange",e)}}}),r.ui.registry.addMenuItem("pageembed",{text:"Insert/edit iframe",icon:"embed-page",onAction:function(e){z(r)}})}function F(e){h(e,function(e){if(k(e)){var n=new tinymce.html.Node("span",1);n.attr("class","mce-shim"),n.attr("data-mce-bogus","1"),e.append(n),e.attr("contenteditable","false")}})}function q(e){h(e,function(e){k(e)&&e.attr("contenteditable",null)})}function H(e){return n(tinymce,"5.0.0")?console.error("The pageembed plugin requires at least 5.0.0 of TinyMCE"):(function(e){e.on("click keyup touchend",function(){X.from(e.selection.getNode()).map(Y.fromDom).each(function(e){L(e)&&(!function(e,n){var r=e.dom();return!(!r||!r.hasAttribute)&&r.hasAttribute(n)}(e,"data-mce-selected")||b(e,"data-mce-selected","2"))})}),e.on("PreInit",function(){e.parser.addNodeFilter("div",F),e.serializer.addNodeFilter("div",q)})}(e),B(e)),{}}var V=function(r){function e(){return o}function n(e){return e(r)}var t=d(r),o={fold:function(e,n){return n(r)},is:function(e){return r===e},isSome:f,isNone:c,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:e,orThunk:e,map:function(e){return V(e(r))},each:function(e){e(r)},bind:n,exists:n,forall:n,filter:function(e){return e(r)?o:l},toArray:function(){return[r]},toString:function(){return"some("+r+")"},equals:function(e){return e.is(r)},equals_:function(e,n){return e.fold(c,function(e){return n(r,e)})}};return o},X={some:V,none:a,from:function(e){return null==e?l:V(e)}},W=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:d(e)}},Y={fromHtml:function(e,n){var r=(n||t.document).createElement("div");if(r.innerHTML=e,!r.hasChildNodes()||1<r.childNodes.length)throw t.console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return W(r.childNodes[0])},fromTag:function(e,n){var r=(n||t.document).createElement(e);return W(r)},fromText:function(e,n){var r=(n||t.document).createTextNode(e);return W(r)},fromDom:W,fromPoint:function(e,n,r){var t=e.dom();return X.from(t.elementFromPoint(n,r)).map(W)}},G=g("string"),$=g("array"),K=g("boolean"),J=g("function"),Q=g("number"),Z=Array.prototype.slice,ee=Array.prototype.push,ne=(J(Array.from)&&Array.from,Object.hasOwnProperty),re=function(e,n){return ne.call(e,n)},te=(t.Node.ATTRIBUTE_NODE,t.Node.CDATA_SECTION_NODE,t.Node.COMMENT_NODE,t.Node.DOCUMENT_NODE,t.Node.DOCUMENT_TYPE_NODE,t.Node.DOCUMENT_FRAGMENT_NODE,t.Node.ELEMENT_NODE,t.Node.TEXT_NODE,t.Node.PROCESSING_INSTRUCTION_NODE,t.Node.ENTITY_REFERENCE_NODE,t.Node.ENTITY_NODE,t.Node.NOTATION_NODE,void 0!==t.window?t.window:Function("return this;")(),function(e,n){return O(e,n,t.Node.DOCUMENT_POSITION_CONTAINED_BY)}),oe=function(e){function n(){return r}var r=e;return{get:n,set:function(e){r=e},clone:function(){return oe(n())}}},ie=function(){return ue(0,0)},ue=function(e,n){return{major:e,minor:n}},ae={nu:ue,detect:function(e,n){var r=String(n).toLowerCase();return 0===e.length?ie():y(e,r)},unknown:ie},se="Firefox",ce=function(e){var n=e.current;return{current:n,version:e.version,isEdge:E("Edge",n),isChrome:E("Chrome",n),isIE:E("IE",n),isOpera:E("Opera",n),isFirefox:E(se,n),isSafari:E("Safari",n)}},fe={unknown:function(){return ce({current:void 0,version:ae.unknown()})},nu:ce,edge:d("Edge"),chrome:d("Chrome"),ie:d("IE"),opera:d("Opera"),firefox:d(se),safari:d("Safari")},le="Windows",de="Android",me="Solaris",pe="FreeBSD",ve=function(e){var n=e.current;return{current:n,version:e.version,isWindows:x(le,n),isiOS:x("iOS",n),isAndroid:x(de,n),isOSX:x("OSX",n),isLinux:x("Linux",n),isSolaris:x(me,n),isFreeBSD:x(pe,n)}},ge={unknown:function(){return ve({current:void 0,version:ae.unknown()})},nu:ve,windows:d(le),ios:d("iOS"),android:d(de),linux:d("Linux"),osx:d("OSX"),solaris:d(me),freebsd:d(pe)},he=function(e,r){return T(e,r).map(function(e){var n=ae.detect(e.versionRegexes,r);return{current:e.name,version:n}})},be=function(e,r){return T(e,r).map(function(e){var n=ae.detect(e.versionRegexes,r);return{current:e.name,version:n}})},we=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Ne=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return S(e,"edge/")&&S(e,"chrome")&&S(e,"safari")&&S(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,we],search:function(e){return S(e,"chrome")&&!S(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return S(e,"msie")||S(e,"trident")}},{name:"Opera",versionRegexes:[we,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:D("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:D("firefox")},{name:"Safari",versionRegexes:[we,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(S(e,"safari")||S(e,"mobile/"))&&S(e,"applewebkit")}}],Oe=[{name:"Windows",search:D("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return S(e,"iphone")||S(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:D("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:D("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:D("linux"),versionRegexes:[]},{name:"Solaris",search:D("sunos"),versionRegexes:[]},{name:"FreeBSD",search:D("freebsd"),versionRegexes:[]}],ye={browsers:d(Ne),oses:d(Oe)},Ee=(oe(function(e,n){var r=ye.browsers(),t=ye.oses(),o=he(r,e).fold(fe.unknown,fe.nu),i=be(t,e).fold(ge.unknown,ge.nu);return{browser:o,os:i,deviceType:function(e,n,r,t){var o=e.isiOS()&&!0===/ipad/i.test(r),i=e.isiOS()&&!o,u=e.isiOS()||e.isAndroid(),a=u||t("(pointer:coarse)"),s=o||!i&&u&&t("(min-device-width:768px)"),c=i||u&&!s,f=n.isSafari()&&e.isiOS()&&!1===/safari/i.test(r),l=!c&&!s&&!f;return{isiPad:d(o),isiPhone:d(i),isTablet:d(s),isPhone:d(c),isTouch:d(a),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:d(f),isDesktop:d(l)}}(i,o,e,n)}}(t.navigator.userAgent,function(e){return t.window.matchMedia(e).matches})).get().browser.isIE(),function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n]}("element","offset"),"tiny-pageembed"),xe=[{text:"Responsive - 21x9",value:"tiny-pageembed--21by9"},{text:"Responsive - 16x9",value:"tiny-pageembed--16by9"},{text:"Responsive - 4x3",value:"tiny-pageembed--4by3"},{text:"Responsive - 1x1",value:"tiny-pageembed--1by1"}];tinymce.PluginManager.add("pageembed",H)}(window);